# AOP
- Aspect Oriented Programming
- 문제를 바라보는 관점을 기준으로 프로그래밍하는 기법
- 문제를 해결하기 위한 핵심 관심 사항과 전체에 적용되는 공통 관심 사항을 기준으로 프로그래밍을 함으로써 공통 모듈을 여러 코드에 쉽게 적용할 수 있도록 도와준다.
- 핵심 로직을 구현한 코드를 컴파일하거나, 컴파일 된 클래스를 로딩하거나, 또는 로딩한 클래스의 객체를 생성할 때 AOP가 적용되어 핵심 로직 구현 코드 안에 고통 기능이 삽입된다.

## AOP 용어

| 용어       | 의미                                                                                                   |
|:-----------|:-------------------------------------------------------------------------------------------------------|
| JointPoint | - Advice를 적용 가능한 지점을 의미한다.                                                                |
|            | - 메서드 호출, 필드 값 변경 등이 해당된다.                                                             |
| Pointcut   | - Jointpoint의 부분 집합으로서 실제 Advice가 적용되는 Jointpoint를 나타낸다.                           |
|            | - 스프링에서는 정규 표현식이나 AspectJ의 문법을 이용하여 Pointcut을 정의할 수 있다.                    |
| Advice     | - 언제 공통 관심 기능을 핵심 로직에 적용할 지를 정의하고 있다.                                         |
|            | - 예를 들어, 메서드 호출하기 전(언제)에 트랜잭션 시작(공통 기능) 기능을 적용한다는 것을 정의하고 있다. |
|Weaving            | - Advice를 핵심 로직 코드에 적용하는 것을 weaving이라고 한다.                                                                                                       |
|            | - 즉, 공통 코드를 핵심 로직 코드에 삽입하는 것이다.                                                                                                       |
|Aspect            |- 여러 객체에 공통으로 적용되는 기능을 Aspect라고 한다.                                                                                                        |
|            |- 트랜잭션이나 보안 등이 Aspect의 좋은 예이다.                                                                                                        |


## 세 가지 Weaving 방식
- 컴파일 시 Weaving
    - AspectJ에서 사용하는 방식
    - 핵심 로직 자바 소스 코드를 컴파일 할 때, 알맞은 위치에 공통 코드를 삽입하면, 컴파일 결과 AOP가 적용된 클래스 파일이 생성된다.
- 클래스 로딩 시 Weaving
    - AOP 라이브러리는 JVM이 클래스를 로딩할 때 클래스 정보를 변경할 수 있는 에이전트를 제공한다.
    - 에이전트는 로딩한 클래스의 바이너리 정보를 변경하여 알맞은 위치에 공통 코드를 삽입한 새로운 클래스 바이너리 코드를 사용하도록 한다.
    - 즉, 원본 클래스 파일은 변경하지 않고 클래스를 로딩할 때 JVM이 변경된 바이트 코드를 사용하도록 함으로써 AOP를 적용한다.
    - AspectJ는 컴파일 방식과 더불어 클래스 로딩 방식을 함께 지원하고 있다.
- 런타임 시 Weaving
    - 소스 코드나 클래스 정보 자체를 변경하지 않는다.
    - 프록시를 이용하여 AOP를 적용한다.
    - 중간에 프록시를 생성하여 프록시를 통해서 핵심 로직을 구현한 객체에 접근하게 된다.
    - 프록시 기반에서는 메서드가 호출될 때에만 Advice를 적용할 수 있으므로, 필드 값 변경과 같은 Jointpoint에 대해서는 적용할 수 없는 한계가 있다.

